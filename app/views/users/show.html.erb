<div class="text-center" id="sort-by">
  <a class="btn btn-large" style="margin-top: 5px;">SORT</a>
  <a class="btn btn-large btn-info" href="#dist" style="margin-top: 5px;">Distance</a>
  <a class="btn btn-large btn-info" href="#last" style="margin-top: 5px;">Last Visit</a>
  <a class="btn btn-large btn-info" href="#name" style="margin-top: 5px;">Name</a>
  <a class="btn btn-large btn-info" href="#hood" style="margin-top: 5px;">Neighborhood</a>
  <a class="btn btn-large btn-warning" href="#score" style="margin-top: 5px;">Score</a>
</div>

<div class="text-center" >
  <%= button_to("Add all of "+@user.username+"'s restaurants!", "getall?id=#{@user.id}", :class => 'btn btn-primary btn-large') %>
</div>
</br>

<div id="container">
<% @user.restaurants.each do |restaurant| %>
    <div class="card text-center item pop">
        <p class="lead"><%= restaurant.name %></p>
        <p><%=restaurant.cuisine%></p>
        <% if restaurant.locations.last.hood %>
          <p><%=restaurant.locations.last.hood%>, <%=restaurant.locations.last.city%></p>
        <% else %>
          <p><%=restaurant.locations.last.city%></p>
        <% end %>
        <div>
          <div class="blockery">
            <a class="text-center"><img src=<%=restaurant.image%>/></p>
          </div>
          <div class="blockery">
            <% if restaurant.lists.count == 1  %>
              <p>On <strong style="color:orange;"><%= restaurant.lists.count %></strong> list</p>
            <% else %>
              <p>On <strong style="color:orange;"><%= restaurant.lists.count %></strong> lists</p>
            <% end %>
            <% if current_user.restaurants.exists?(restaurant.id) %>
              <p>On your list</p>
            <% else %>
              <%= button_to('Add to List', "/lists/create?id=#{restaurant.id}", :class => 'btn btn-primary btn-small') %>
              <p></p>
            <% end %>
            <p><a href="<%=restaurant.yelp_url%>" target="_blank"><img src="http://s3-media1.ak.yelpcdn.com/assets/2/www/img/55e2efe681ed/developers/yelp_logo_50x25.png"></a></p>
          </div>
        </div>
        <% if restaurant.lists.find_by(user_id: @user.id).label == "favorite" %>
          <p><strong style="color:orange;"><%= @user.username %> favorite</strong></p>
        <% end %>
    </div>
<% end %>
</div>
<script>
  $(function(){
    var $container = $('#container');
    $('#container').isotope({
      // options
      itemSelector : '.item',
      layoutMode : 'fitRows',
      getSortData : {
        name : function ( $elem ) {
          return $elem.find('.name').text();
        },
        hood : function ( $elem ) {
          return $elem.find('.hood').text();
        },
        dist : function ( $elem ) {
          return parseInt($elem.find('.dist').text());
        }
      }
    });

    $('#sort-by a').click(function(){
      // get href attribute, minus the '#'
      var sortName = $(this).attr('href').slice(1);
      if(sortName == "last" || sortName == "score"){
        $('#container').isotope({ sortBy : sortName, sortAscending: false });
      } else{
        $('#container').isotope({ sortBy : sortName });
      }
      return false;
    });

    $('#filters a').click(function(){
      var selector = $(this).attr('data-filter');
      $container.isotope({ filter: selector });
      return false;
    });

    $('#asc-desc a').click(function(){
      var order = $(this).attr('href').slice(1);
      if(order == "asc"){
        $('#container').isotope({ sortAscending: true });
      }else if(order == "desc"){
        $('#container').isotope({ sortAscending: false });
      }
      return false;
    });
  });
</script>









